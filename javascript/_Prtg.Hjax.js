(function(_Prtg,$,window,document,undefined){var module_name="prtg_hjax",namespaces={},timeout=null,sitename=$("<div>"+_Prtg.Options.sitename+"</div>").text();History.Adapter.bind(window,"statechange",function(e){var State=History.getState();e.stopImmediatePropagation();if(State.data.namespace&&namespaces[State.data.namespace]){var namespace=namespaces[State.data.namespace];namespace.handler.call(namespace.context,namespace.data,State,e)}else loadLink(State.url,State.data)});function bind(namespace,
handler,context,data){if(typeof handler!=="function")throw new Error("State handler must be a function!");namespaces[namespace]={handler:handler,data:data||{},context:context||null}}function unbind(namespace){delete namespaces[namespace]}function navigate(){var url;var container;var namespace;var data;_Prtg.xhrManager.xhrabort();if(typeof arguments[0]==="object"){url=arguments[0].url||"";container=arguments[0].container||"#container";namespace=arguments[0].namespace||"linkloader.prtg";data=arguments[0].data||
{}}else return;History.pushState({container:container,namespace:namespace,data:data},window.title,url.split("#")[0])}function loadLink(url,stateData){var $container;var edata=stateData.data;var dataurl;var data={_hjax:true};if(_Prtg.Util.getUrlVars()["showtiming"]==="1")_Prtg.Options["showtiming"]=1;if(!!_Prtg.Options.showtiming)data["showtiming"]=1;_Prtg.Events.publish("navigate.prtg",stateData.container);$container=!stateData.container?$("#container"):!(stateData.container instanceof jQuery)?$(stateData.container):
stateData.container;if(!!edata&&edata.url){dataurl=edata.url.split("#");dataurl=dataurl[0]+"?"+url.split("?")[1]+(dataurl.length<=1?"&":($container=$("#"+dataurl[1]),"#"+dataurl[1]))}else{dataurl=url;_Prtg.Plugins["crumblerSensorStats"].plugin.id=_Prtg.Util.getUrlParameters(dataurl)["id"]||null}_Prtg.Tip.killPopups();$container.addClass("loading");$(window).scrollTop(0);return $.ajax({url:dataurl,dataType:"html",data:data,beforeSend:function(jqXHR){jqXHR.peNumber="PE1113"},success:function(data,textStatus,
jqXHR){$container.removeClass("loading").removeData().children().remove();if(!!edata&&edata.url)$container.html($(data).html());else $container.html(data);timeout=null;var CurrentTitle=window.title=document.title;window.title=document.title=$container.find("[data-title]").attr("data-title")+" | "+sitename;_Prtg.Events.publish("refresh.events.prtg");_Prtg.SetupPage($container);!!window.__ga&&window.__ga("send","pageview",window.__gaStripOrigin(dataurl));_Prtg.Events.publish("loaded.events.prtg",$container,
stateData.data)}})}function linkClickHandler(e){var $me=$(this);var data=!!$me.data()&&!!$me.data().url&&{url:$me.data().url}||{};if(e.ctrlKey||e.metaKey)return;if($me.hasClass("logout")||$me.attr("href")===undefined||$me.attr("href")==="/home")return;if(window.winGUI===true){window.location.href=e.currentTarget.href;return}if(!!timeout)return;timeout=e;e.preventDefault();if(!e.data)throw new Error("Hjax.linkHandler: event.data missing namespace and container");else navigate({url:$me.attr("href"),
container:e.data.container,namespace:e.data.namespace,data:data});return false}$.extend(true,window,{_Prtg:{Hjax:{loadLink:function(url,namespace,container,data){return navigate.call(null,{url:url||"",namespace:namespace||"linkloader.prtg",container:container||"#container",data:data||null})},bind:bind,unbind:unbind,navigate:navigate}}});$(document).on("click.hjax.prtg",'#header_menu a:not(.nohjax,[href*=":"]), #crumblersensorstats a:not(.nohjax,[href*=":"]), #main a:not([href^="#"], [href*=":"], [target], [onclick], .nohjax, .as-dialog), #header_breadcrumbs a:not(.nohjax), #mainstuff a:not([href^="#"], [href*=":"], [target], [onclick], .nohjax, .as-dialog)',
{namespace:"linkloader.prtg",container:"#container"},linkClickHandler)})(_Prtg,jQuery,window,document);
